/*! https://github.com/leeoniya/uDSV (v0.1.0) */
var uDSV=function(e){"use strict";const t='"',l=["\t","|",";",","],n=5e3;function s(e,l,s,i,r){let h=l.cols.delim,o=l.rows.delim,c=r||l.cols.names.length,f=null!=i,a=null!=r&&f,d=o.length;if(!l.quote){let t=[],l=0,r=-1;for(;(r=e.indexOf(o,l))>-1&&(t.push(e.slice(l,r).split(h)),l=r+d,!f||t.length!==i);)t.length===n&&(s(t),t=[]);return void(t.length>0&&s(t))}let u=o.charCodeAt(0),g=h.charCodeAt(0);const p=a?RegExp(`[^${h}${o}]+`,"my"):null;let m,A=0,x=0,y=e.length-1,O=[],C="",v=Array(c),E=0,N=c-1;for(;y>=x;){if(m=e.charCodeAt(x),0===A)if(34===m)A=2,x+=1,m=e.charCodeAt(x);else if(m===g||m===u){if(v[E]=C,E+=1,x+=1,C="",m===u){if(O.push(v),f&&O.length===i)return void s(O);O.length===n&&(s(O),O=[]),v=Array(c),E=0,x+=d-1}m=e.charCodeAt(x)}else A=1;if(2===A)if(34===m)34===e.charCodeAt(x+1)?(C+=t,x+=2):(A=0,x+=1);else{let l=e.indexOf(t,x);C+=e.slice(x,l),x=l}else if(1===A)if(m===g||m===u){if(v[E]=C,E+=1,x+=1,C="",m===u){if(O.push(v),f&&O.length===i)return void s(O);O.length===n&&(s(O),O=[]),v=Array(c),E=0,x+=d-1}A=0}else if(a){p.lastIndex=x;let t=p.exec(e)[0];C+=t,x+=t.length}else{let t;E===N?(t=e.indexOf(o,x),-1===t&&(t=e.length)):t=e.indexOf(h,x),C+=e.slice(x,t),x=t}}v[E]=C,O.push(v),s(O)}return e.parse=s,e.schema=function(e,n=10){const i=e.match(/(.*)(\r?\n?)/),r=i[1],h=i[2],o=l.find((e=>r.indexOf(e)>-1)),c={quote:e.indexOf(t)>-1?t:"",cols:{delim:o,names:[],types:[]},rows:{delim:h}},f=r.split(o).length,a=[];s(e,c,(e=>a.push(...e)),n,f);const d=Object.keys(a.shift());return c.cols.names=d,c.cols.types=Array(d.length).fill("s"),a.forEach((e=>{e.forEach(((e,t)=>{Number.isNaN(+e)||(c.cols.types[t]="n")}))})),c},e}({});
