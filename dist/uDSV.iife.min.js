/*! https://github.com/leeoniya/uDSV (v0.1.0) */
var uDSV=function(e){"use strict";const l='"',t=["\t","|",";",","];function n(e,t,n,s=5e3,i=null,r=null){let f=t.cols.delim,c=t.rows.delim,o=r||t.cols.names.length,h=null!=i,u=null!=r&&h,a=c.length,d=0;if(null==t.quote){let l=[],t=0,r=-1;for(;(r=e.indexOf(c,t))>-1&&(l.push(e.slice(t,r).split(f)),t=r+a,l.length!==s||(n(l),l=[],!h||++d!==i)););return void(l.length>0&&n(l))}let g=c.charCodeAt(0),p=f.charCodeAt(0);const m=u?RegExp(`[^${f}${c}]+`,"my"):null;let A,x=0,y=0,C=e.length-1,O=[],b="",E=Array(o),N=0,k=o-1;for(;C>=y;){if(A=e.charCodeAt(y),0===x)if(34===A)x=2,y+=1,A=e.charCodeAt(y);else if(A===p||A===g){if(E[N]=b,N+=1,y+=1,b="",A===g){if(O.push(E),O.length===s&&(n(O),O=[],h&&++d===i))return;E=Array(o),N=0,y+=a-1}A=e.charCodeAt(y)}else x=1;if(2===x)for(;;)if(34===A){if(34!==e.charCodeAt(y+1)){x=0,y+=1;break}b+=l,y+=2,A=e.charCodeAt(y)}else{let t=e.indexOf(l,y);b+=e.slice(y,t),y=t,A=34}else if(1===x)if(A===p||A===g){if(E[N]=b,N+=1,y+=1,b="",A===g){if(O.push(E),O.length===s&&(n(O),O=[],h&&++d===i))return;E=Array(o),N=0,y+=a-1}x=0}else if(u){m.lastIndex=y;let l=m.exec(e)[0];b+=l,y+=l.length}else{let l;N===k?(l=e.indexOf(c,y),-1===l&&(l=e.length)):l=e.indexOf(f,y),b+=e.slice(y,l),y=l}}E[N]=b,O.push(E),n(O)}return e.parse=n,e.schema=function(e,s=10){const i=e.match(/(.*)(\r?\n?)/),r=i[1],f=i[2],c=t.find((e=>r.indexOf(e)>-1)),o={quote:e.indexOf(l)>-1?l:null,cols:{delim:c,names:[],types:[]},rows:{delim:f}},h=r.split(c).length,u=[];n(e,o,(e=>u.push(...e)),s,1,h);const a=Object.keys(u.shift());return o.cols.names=a,o.cols.types=Array(a.length).fill("s"),u.forEach((e=>{e.forEach(((e,l)=>{Number.isNaN(+e)||(o.cols.types[l]="n")}))})),o},e}({});
