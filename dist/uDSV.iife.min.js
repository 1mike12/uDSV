/*! https://github.com/leeoniya/uDSV (v0.1.0) */
var uDSV=function(e){"use strict";const l=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d{3,})?(?:Z|[-+]\d{2}:?\d{2})$/,t=/^(?:t(?:rue)?|f(?:alse)?|y(?:es)?|n(?:o)?|0|1)$/i,n=["\t","|",";",","],r="d",i="n",s="j",o="b";function a(e,l){let{type:t}=l,n=`r[${e}]`,a=t===r?`new Date(${n})`:t===s?`JSON.parse(${n})`:t===i?`Number.parseFloat(${n})`:t[0]===o?`${n} === '${t.slice(2)}' ? true : false`:n;return`${void 0!==l.empty?`${n} === '' ? ${l.empty} : `:""} ${void 0!==l.null?`${n} === 'null' || ${n} === 'NULL' ? ${l.null} : `:""} ${void 0!==l.NaN&&t===i?`${n} === 'NaN' ? ${l.NaN} : `:""} ${a}`}const u=/\w+(?:\[|\]?[\.\[]?|$)/gm;function c(e,l=!1,t=!1){let n="";if(l&&t){let l={},t=0,r=e.map((e=>e.name));do{let e=r.shift(),n=/\s/.test(e)?[e]:[...e.matchAll(u)].flatMap((e=>e.map((e=>e.replace("]",""))))),i=l;do{let e=n.shift(),l=e,r=e.at(-1);"."==r||"["==r?(l=e.slice(0,-1),i=i[l]=i[l]??("."==r?{}:[])):i[l]=`¦${t}¦`}while(n.length>0);t++}while(r.length>0);n=JSON.stringify(l).replace(/"¦(\d+)¦"/g,((l,t)=>a(+t,e[+t])))}else n=l?"{":"[",e.forEach(((e,t)=>{n+=l?`"${e.name.replaceAll('"','\\"')}":`:"";let r=a(t,e);n+=r+","})),n+=l?"}":"]";return Function("rows",` let arr = Array(rows.length); for (let i = 0; i < rows.length; i++) { let r = rows[i]; arr[i] = ${n}; } return arr; `)}function f(e,l,t,n=!0,r=1e3,i=null,s=null){let[o,a,u]=l.delims,c=s||l.cols.length,f=null!=i,h=null!=s&&f,d=o.length,g=0;if(""===u){let l=e.split(o),s="",u=l.length;n||(u-=1,s=l[u]);let c=[];for(let e=0;u>e;e++){let n=l[e].split(a);if(c.push(n),c.length===r&&(t(c,g++,""),c=[],f&&g===i))return}return void((c.length>0||""!==s)&&t(c,g++,s))}let p=""==u?0:u.charCodeAt(0),$=o.charCodeAt(0),N=a.charCodeAt(0);const m=h?RegExp(`[^${a}${o}]+`,"my"):null,y=Array(c).fill("");let A,w=0,b=0,C=e.length-1,O=0,x=[],v="",E=y.slice(),k=0,F=c-1,S=-1;for(;C>=b;){if(A=e.charCodeAt(b),0===w)if(A===p){if(w=2,b+=1,b>C)break;A=e.charCodeAt(b)}else if(A===N||A===$){if(E[k]=v,S=k,k+=1,b+=1,v="",A===$){if(h&&F>S&&0===x.length&&(E.length=y.length=S+1,F=S),x.push(E),x.length===r&&(t(x,g++,""),x=[],f&&g===i))return;E=y.slice(),k=0,S=-1,b+=d-1,O=b}if(b>C)break;A=e.charCodeAt(b)}else w=1;if(2===w)for(;;)if(A===p){if(b+1>C){b=C+1;break}if(e.charCodeAt(b+1)!==p){w=0,b+=1;break}if(v+=u,b+=2,b>C){b=C+1;break}A=e.charCodeAt(b)}else{let l=e.indexOf(u,b);if(-1===l){b=C+1;break}v+=e.slice(b,l),b=l,A=p}else if(1===w)if(A===N||A===$){if(E[k]=v,S=k,k+=1,b+=1,v="",A===$){if(h&&F>S&&0===x.length&&(E.length=y.length=S+1,F=S),x.push(E),x.length===r&&(t(x,g++,""),x=[],f&&g===i))return;E=y.slice(),k=0,S=-1,b+=d-1,O=b}w=0}else if(h){m.lastIndex=b;let l=m.exec(e)[0];v+=l,b+=l.length}else{let l=e.indexOf(k===F?o:a,b);-1===l&&(l=C+1),v+=e.slice(b,l),b=l}}n&&k===F&&(E[k]=v,x.push(E),w=0),t(x,g++,n||0===w&&!(-1===S?""!==v:F>S)?"":e.slice(O))}return e.parse=f,e.schema=function(e,a,u,h,d,g){d??=10,g??=4096;const p=RegExp(`(.*)(${h??"\r\n|\r|\n"})`),$=e.match(p),N=$[1];h??=$[2],a??=n.find((e=>N.indexOf(e)>-1))??"",u??=e.indexOf('"')>-1?'"':"";let m=null,y=null,A=null,w=null;const b={delims:[h,a,u],cols:[],toArrs:e=>(m??=c(b.cols,!1,!1),m(e)),toObjs:e=>(y??=c(b.cols,!0,!1),y(e)),toDeep:e=>(w??=c(b.cols,!0,!0),w(e)),toCols:e=>(A??=function(e){return Function("rows",` let cols = [${e.map((()=>"Array(rows.length)")).join(",")}]; for (let i = 0; i < rows.length; i++) { let r = rows[i]; ${e.map(((e,l)=>`cols[${l}][i] = r[${l}]`)).join(";")}; } return cols; `)}(b.cols),A(e))},C=N.split(a).length,O=e.length>g?e.slice(0,g):e,x=[];return f(O,b,(e=>x.push(...e)),O.length===e.length,d,1,C),x.shift().forEach(((e,n)=>{const a=function(e,n){let a=n.find((l=>""!==l[e]&&"null"!==l[e]&&"NULL"!==l[e]&&"NaN"!==l[e])),u="s";if(null!=a){let n=a[e];u=l.test(n)?r:Number.isNaN(Number.parseFloat(n))?t.test(n)?o+":"+function(e){let[l,t=""]=e;return"1"==l||"0"==l?"1":"t"==l||"f"==l?""==t?"t":"true":"T"==l||"F"==l?""==t?"T":"R"==t||"A"===t?"TRUE":"True":"y"==l||"n"==l?""==t?"y":"yes":"Y"==l||"N"==l?""==t?"Y":"E"==t||"O"===t?"YES":"Yes":""}(n):function(e){if("["===e[0]||"{"===e[0])try{return JSON.parse(e),!0}catch{}return!1}(n)?s:u:i}return u}(n,x);b.cols.push({type:a,name:e,empty:null,NaN:void 0,null:void 0})})),b},e}({});
