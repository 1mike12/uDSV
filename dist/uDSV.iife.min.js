/*! https://github.com/leeoniya/uDSV (v0.1.0) */
var uDSV=function(e){"use strict";const t='"',l=["\t","|",";",","];function n(e,l,n,s,i){let r=l.cols.delim,h=l.rows.delim,o=i||l.cols.names.length,c=null!=s,f=null!=i&&c,a=h.length;if(!l.quote){let t=[],l=0,i=-1;for(;(i=e.indexOf(h,l))>-1&&(t.push(e.slice(l,i).split(r)),l=i+a,!c||t.length!==s);)5e3===t.length&&(n(t),t=[]);return void(t.length>0&&n(t))}let d=h.charCodeAt(0),u=r.charCodeAt(0);const g=f?RegExp(`[^${r}${h}]+`,"my"):null;let p=0,m=0,A=e.length-1,x=[],y="",O=Array(o),C=0,v=o-1;for(;A>=m;){let l=e.charCodeAt(m);if(0===p)if(34===l)p=2,m+=1,l=e.charCodeAt(m);else if(l===u||l===d){if(O[C]=y,C+=1,m+=1,y="",l===d){if(x.push(O),c&&x.length===s)return void n(x);5e3===x.length&&(n(x),x=[]),O=Array(o),C=0,m+=a-1}l=e.charCodeAt(m)}else p=1;if(2===p)if(34===l)34===e.charCodeAt(m+1)?(y+=t,m+=2):(p=0,m+=1);else{let l=e.indexOf(t,m);y+=e.slice(m,l),m=l}else if(1===p)if(l===u||l===d){if(O[C]=y,C+=1,m+=1,y="",l===d){if(x.push(O),c&&x.length===s)return void n(x);5e3===x.length&&(n(x),x=[]),O=Array(o),C=0,m+=a-1}p=0}else if(f){g.lastIndex=m;let t=g.exec(e)[0];y+=t,m+=t.length}else{let t;C===v?(t=e.indexOf(h,m),-1===t&&(t=e.length)):t=e.indexOf(r,m),y+=e.slice(m,t),m=t}}O[C]=y,x.push(O),n(x)}return e.parse=n,e.schema=function(e,s=10){const i=e.match(/(.*)(\r?\n?)/),r=i[1],h=i[2],o=l.find((e=>r.indexOf(e)>-1)),c={quote:e.indexOf('"')>-1?t:"",cols:{delim:o,names:[],types:[]},rows:{delim:h}},f=r.split(o).length+1,a=[];n(e,c,(e=>a.push(...e)),s,f);const d=Object.keys(a.shift());return c.cols.names=d,c.cols.types=Array(d.length).fill("s"),a.forEach((e=>{e.forEach(((e,t)=>{Number.isNaN(+e)||(c.cols.types[t]="n")}))})),c},e}({});
