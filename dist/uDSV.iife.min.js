/*! https://github.com/leeoniya/uDSV (v0.1.0) */
var uDSV=function(e){"use strict";const t='"',l=["\t","|",";",","],n=5e3;function s(e,l,s,i,r){let h=l.cols.delim,o=l.rows.delim,c=r||l.cols.names.length,f=null!=i,a=null!=r&&f,d=o.length;if(!l.quote){let t=[],l=0,r=-1;for(;(r=e.indexOf(o,l))>-1&&(t.push(e.slice(l,r).split(h)),l=r+d,!f||t.length!==i);)t.length===n&&(s(t),t=[]);return void(t.length>0&&s(t))}let u=o.charCodeAt(0),g=h.charCodeAt(0);const p=a?RegExp(`[^${h}${o}]+`,"my"):null;let m=0,A=0,x=e.length-1,y=[],O="",C=Array(c),v=0,E=c-1;for(;x>=A;){let l=e.charCodeAt(A);if(0===m)if(34===l)m=2,A+=1,l=e.charCodeAt(A);else if(l===g||l===u){if(C[v]=O,v+=1,A+=1,O="",l===u){if(y.push(C),f&&y.length===i)return void s(y);y.length===n&&(s(y),y=[]),C=Array(c),v=0,A+=d-1}l=e.charCodeAt(A)}else m=1;if(2===m)if(34===l)34===e.charCodeAt(A+1)?(O+=t,A+=2):(m=0,A+=1);else{let l=e.indexOf(t,A);O+=e.slice(A,l),A=l}else if(1===m)if(l===g||l===u){if(C[v]=O,v+=1,A+=1,O="",l===u){if(y.push(C),f&&y.length===i)return void s(y);y.length===n&&(s(y),y=[]),C=Array(c),v=0,A+=d-1}m=0}else if(a){p.lastIndex=A;let t=p.exec(e)[0];O+=t,A+=t.length}else{let t;v===E?(t=e.indexOf(o,A),-1===t&&(t=e.length)):t=e.indexOf(h,A),O+=e.slice(A,t),A=t}}C[v]=O,y.push(C),s(y)}return e.parse=s,e.schema=function(e,n=10){const i=e.match(/(.*)(\r?\n?)/),r=i[1],h=i[2],o=l.find((e=>r.indexOf(e)>-1)),c={quote:e.indexOf(t)>-1?t:"",cols:{delim:o,names:[],types:[]},rows:{delim:h}},f=r.split(o).length+1,a=[];s(e,c,(e=>a.push(...e)),n,f);const d=Object.keys(a.shift());return c.cols.names=d,c.cols.types=Array(d.length).fill("s"),a.forEach((e=>{e.forEach(((e,t)=>{Number.isNaN(+e)||(c.cols.types[t]="n")}))})),c},e}({});
