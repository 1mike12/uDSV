/*! https://github.com/leeoniya/uDSV (v0.1.0) */
var uDSV=function(e){"use strict";const l='"',t=["\t","|",";",","];function n(e,t,n,s=5e3,i=null,r=null){let c=t.cols.delim,f=t.rows.delim,o=r||t.cols.names.length,h=null!=i,u=null!=r&&h,a=f.length,d=0;if(null==t.quote){let l=[],t=0,r=-1;for(;(r=e.indexOf(f,t))>-1&&(l.push(e.slice(t,r).split(c)),t=r+a,l.length!==s||(n(l),l=[],!h||++d!==i)););return void(l.length>0&&n(l))}let g=f.charCodeAt(0),p=c.charCodeAt(0);const m=u?RegExp(`[^${c}${f}]+`,"my"):null;let A,x=0,y=0,O=e.length-1,C=[],E="",N=Array(o),b=0,q=o-1;for(;O>=y;){if(A=e.charCodeAt(y),0===x)if(34===A)x=2,y+=1,A=e.charCodeAt(y);else if(A===p||A===g){if(N[b]=E,b+=1,y+=1,E="",A===g){if(C.push(N),C.length===s&&(n(C),C=[],h&&++d===i))return;N=Array(o),b=0,y+=a-1}A=e.charCodeAt(y)}else x=1;if(2===x)if(34===A)34===e.charCodeAt(y+1)?(E+=l,y+=2):(x=0,y+=1);else{let t=e.indexOf(l,y);E+=e.slice(y,t),y=t}else if(1===x)if(A===p||A===g){if(N[b]=E,b+=1,y+=1,E="",A===g){if(C.push(N),C.length===s&&(n(C),C=[],h&&++d===i))return;N=Array(o),b=0,y+=a-1}x=0}else if(u){m.lastIndex=y;let l=m.exec(e)[0];E+=l,y+=l.length}else{let l;b===q?(l=e.indexOf(f,y),-1===l&&(l=e.length)):l=e.indexOf(c,y),E+=e.slice(y,l),y=l}}N[b]=E,C.push(N),n(C)}return e.parse=n,e.schema=function(e,s=10){const i=e.match(/(.*)(\r?\n?)/),r=i[1],c=i[2],f=t.find((e=>r.indexOf(e)>-1)),o={quote:e.indexOf(l)>-1?l:null,cols:{delim:f,names:[],types:[]},rows:{delim:c}},h=r.split(f).length,u=[];n(e,o,(e=>u.push(...e)),s,1,h);const a=Object.keys(u.shift());return o.cols.names=a,o.cols.types=Array(a.length).fill("s"),u.forEach((e=>{e.forEach(((e,l)=>{Number.isNaN(+e)||(o.cols.types[l]="n")}))})),o},e}({});
