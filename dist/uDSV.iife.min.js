/*! https://github.com/leeoniya/uDSV (v0.1.0) */
var uDSV=function(e){"use strict";const t='"';function l(e,l,n,s,i){let r=l.cols.delim,f=l.rows.delim,c=s||l.cols.names.length,h=!(!s||!n),o=f.length;if(!l.quote){let t=[],l=0,s=-1;for(;(s=e.indexOf(f,l))>-1;){if(t.push(e.slice(l,s).split(r)),l=s+o,n&&t.length===n){i(t);break}5e3===t.length&&(i(t),t=[])}return}let a=f.charCodeAt(0),u=r.charCodeAt(0);const d=h?RegExp(`[^${r}${f}]+`,"my"):null;let g=0,m=0,p=e.length-1,x=[],A="",y=Array(c),O=0,C=c-1;for(;p>=m;){let l=e.charCodeAt(m);if(0===g)if(34===l)g=2,m+=1,l=e.charCodeAt(m);else if(l===u||l===a){if(y[O]=A,O+=1,m+=1,A="",l===a){if(x.push(y),n&&x.length===n)return void i(x);5e3===x.length&&(i(x),x=[]),y=Array(c),O=0,m+=o-1}l=e.charCodeAt(m)}else g=1;if(2===g)if(34===l)34===e.charCodeAt(m+1)?(A+=t,m+=2):(g=0,m+=1);else{let l=e.indexOf(t,m);A+=e.slice(m,l),m=l}else if(1===g)if(l===u||l===a){if(y[O]=A,O+=1,m+=1,A="",l===a){if(x.push(y),n&&x.length===n)return void i(x);5e3===x.length&&(i(x),x=[]),y=Array(c),O=0,m+=o-1}g=0}else if(h){d.lastIndex=m;let t=d.exec(e)[0];A+=t,m+=t.length}else{let t;O===C?(t=e.indexOf(f,m),-1===t&&(t=e.length)):t=e.indexOf(r,m),A+=e.slice(m,t),m=t}}y[O]=A,x.push(y),i(x)}return e.parse=function(e,t,n,s){return l(e,t,n,null,s)},e.schema=function(e){const n=e.match(/(.*)(\r?\n?)/),s=n[1],i=n[2],r=s.indexOf("\t")>-1?"\t":s.indexOf("|")>-1?"|":s.indexOf(";")>-1?";":",",f={quote:e.indexOf('"')>-1?t:"",cols:{delim:r,names:[],types:[]},rows:{delim:i}},c=s.match(RegExp(r,"g")).length+1,h=[];l(e,f,10,c,(e=>h.push(...e)));const o=Object.keys(h.shift());return f.cols.names=o,f.cols.types=Array(o.length).fill("s"),h.forEach((e=>{e.forEach(((e,t)=>{Number.isNaN(+e)||(f.cols.types[t]="n")}))})),f},e}({});
