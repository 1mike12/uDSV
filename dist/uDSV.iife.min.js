/*! https://github.com/leeoniya/uDSV (v0.1.0) */
var uDSV=function(e){"use strict";const t='"';function l(e,l,n,s){let r=l.cols.delim,i=l.rows.delim,f=s||l.cols.names.length,c=!(!s||!n),o=i.length;if(!l.quote){let t=[],l=0,s=-1;for(;(s=e.indexOf(i,l))>-1&&(t.push(e.slice(l,s).split(r)),l=s+o,t.length!==n););return t}let h=i.charCodeAt(0),a=r.charCodeAt(0);const u=c?RegExp(`[^${r}${i}]+`,"my"):null;let d=0,g=0,m=e.length-1,x=[],p="",A=Array(f),y=0,O=f-1;for(;m>=g;){let l=e.charCodeAt(g);if(0===d)if(34===l)d=2,g+=1,l=e.charCodeAt(g);else if(l===a||l===h){if(A[y]=p,y+=1,g+=1,p="",l===h){if(x.push(A),n&&x.length===n)return x;A=Array(f),y=0,g+=o-1}l=e.charCodeAt(g)}else d=1;if(2===d)if(34===l)34===e.charCodeAt(g+1)?(p+=t,g+=2):(d=0,g+=1);else{let l=e.indexOf(t,g);p+=e.slice(g,l),g=l}else if(1===d)if(l===a||l===h){if(A[y]=p,y+=1,g+=1,p="",l===h){if(x.push(A),n&&x.length===n)return x;A=Array(f),y=0,g+=o-1}d=0}else if(c){u.lastIndex=g;let t=u.exec(e)[0];p+=t,g+=t.length}else{let t;y===O?(t=e.indexOf(i,g),-1===t&&(t=e.length)):t=e.indexOf(r,g),p+=e.slice(g,t),g=t}}return A[y]=p,x.push(A),x}return e.parse=function(e,t,n){return l(e,t,n)},e.schema=function(e){const n=e.match(/(.*)(\r?\n?)/),s=n[1],r=n[2],i=s.indexOf("\t")>-1?"\t":s.indexOf("|")>-1?"|":s.indexOf(";")>-1?";":",",f={quote:e.indexOf('"')>-1?t:"",cols:{delim:i,names:[],types:[]},rows:{delim:r}},c=s.match(RegExp(i,"g")).length+1,o=l(e,f,10,c),h=Object.keys(o.shift());return f.cols.names=h,f.cols.types=Array(h.length).fill("s"),o.forEach((e=>{e.forEach(((e,t)=>{Number.isNaN(+e)||(f.cols.types[t]="n")}))})),f},e}({});
